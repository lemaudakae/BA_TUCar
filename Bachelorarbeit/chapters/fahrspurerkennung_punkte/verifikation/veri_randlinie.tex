\subsection{seitliche Fahrbahnmarkierungen \dcsecondauthorshort}

\begin{algorithm}
\SetKwFunction{Abstand}{Abstand}
\SetKwFunction{Min}{Minimum}
\SetKwFunction{Betrag}{Betrag}
\SetKw{Break}{break}
\KwIn{\(pl\)\{Hypothese\}(Punkt-Index): Punkte der linken Linie\\ \(pr\)\{Hypothese\}(Punkt-Index): Punkte der rechten Linie \\
\(s\): Maximalabweichung des Punktabstands vom Sollwert \\ \(b\): Fahrspurbreite}
\KwOut{\(plv\)(Punkt-Index): verifizierte Punkte der linken Linie}
	\For{\(i=1\) \KwTo Anzahl Hypothesen der linken Linie}{
		\For{\(j=1\) \KwTo Anzahl Hypothesen der rechten Linie}{
			\For{\(k=1\) \KwTo Anzahl Punkte der linken Linienhypothese \(pl\)\{\(i\)\}}{
				\tcc{simultane Berechnung des Abstands von Punkt \(pl\)\{\(i\)\}(\(k\)) zu allen Punkte der rechten Linienhypothese \(pr\)\{\(j\)\}; \(d\) ist Vektor!} 
				\(d\) = \Abstand{\(pl\)\{\(i\)\}(\(k\)), \(pr\)\{\(j\)\}} \\
				\tcc{Minimalen Abstand zwischen Punkt \(pl\)\{\(i\)\}(\(k\)) und der rechten Linienhypothese \(pr\)\{\(j\)\} betrachten}
				 \(dmin\) = \Min{\(d\)} \\
				 \tcc{Nach Abziehen der Fahrspurbreite Betrag des Fehlers auswerten}
				 \(err\) = \Betrag{\(dmin - 2\cdot b\)} \\
				 \If{\(err < s\)}{
				 	\(plvTmp\)(k) = \(pl\)\{\(i\)\}(\(k\))
				 }
				 \Else{
				 \tcc{Abbruch bei einmaliger Überschreitung des Fehlerschwellwertes, Punkte die im weiteren Verlauf des Riverflow-Algorithmus gefunden wurden, werden nicht betrachtet}
				 	\Break
				 }
				 \If{Anzahl Punkte \(plv\) \(<\) Anzahl Punkte \(plvTmp\)}{
				 \tcc{längste verifizierbare Koordinatenserie halten}	
				 	\(plv\) = \(plvTmp\)
				 }
			} 
		}
	}
\end{algorithm}
\subsubsection{Seitenlinienvergleich} 
\label{sssec:fahrspurerkennung:riverflow:verifikation:seitenlinienvergleich}
Zuerst wird der Abstand der äußeren Fahrbahnmarkierungen zueinander geprüft. Diese Validierung bedient sich ineinander verschachtelter Schleifen, um zu jedem Punkt das passende Gegenüber zu finden. Exemplarisch wird diese Schachtelung nun am Beispiel der Beurteilung der linken Fahrbahnmarkierungspunkte anhand der rechten Linie dargelegt. Es wird:
\begin{enumerate}
\item 
Eine Hypothese der linken Linie gewählt.
\item \label{item:riverflow:verification:l_r:loops:right_hypo}
Eine Hypothese der rechten Fahrbahnmarkierung selektiert.
\item \label{item:riverflow:verification:l_r:loops:point}
Ein Punkt der gewählten linken Linienhypothese ausgesucht.
\end{enumerate}
Nun kann simultan der Abstand \nrm{\gls{lat:av}} \eqref{eq:norm:distpoints} 
zu allen Punkten der gewählten rechten Fahrbahnmarkierungshypothese berechnet werden. 
\begin{equation}
\label{eq:norm:distpoints} 
\nrm{\gls{lat:av}} = \nrm{\pnt{p_{\text{links}}} - \pnt{p_{\text{rechts}}}} 
\end{equation}
Da der nächstgelegene Punkt der rechten Linienhypothese zum gewählten Punkt der linken Fahrbahnmarkierungshypothese gefragt ist, wird nur das kleinste Ergebnis dieser simultanen Berechnung weiter betrachtet.

Die Koordinatenserie der linken Linienhypothese wird vom Anfangspunkt des Riverflow-Algorithmus bis
\begin{itemize}
\item der Endpunkt derselben erreicht ist 
\item der Abstand zur gewählten rechten Fahrbahnmarkierungshypothese einmal überschritten wurde
\end{itemize}
nacheinander bearbeitet (siehe Schleife~\ref{item:riverflow:verification:l_r:loops:point}). Die so anhand einer selektierten rechten Linienhypothese verifizierte linke Koordinatenserie wird zwischengespeichert. 
Nach Validieren mittels aller rechten Fahrbahnmarkierungshypothesen (siehe Schleife~\ref{item:riverflow:verification:l_r:loops:right_hypo}) kann nun die längste verifizierte Koordinatenserie der gewählten linken Linienhypothese ermittelt werden.

Der beschriebene Prozess wird nun für alle linken Fahrbahnmarkierungshypothesen ausgeführt. Die linke Linienhypothese mit der größten Anzahl Punkte wird als mithilfe der rechten Fahrbahnmarkierung validierte linke Linie betrachtet. Der prinzipiell gleiche Algorithmus wird für die Verifikation der rechten Fahrbahnmarkierung anhand der linken Linie genutzt.

\subsubsection{Beurteilung der Seitenlinien anhand der mittleren Fahrbahnmarkierung}
\paragraph{lineare Interpolation}
Da in einem Bild signifikant weniger Mittellinienpunkte (genauer: Mittelpunkte der Mittellinienelemente) als Punkte der seitlichen Fahrbahnmarkierung gefunden werden, müssen zur Validierung der Seitenlinienpunkte durch die mittlere Fahrbahnmarkierung zusätzliche Punkte auf selbiger erzeugt werden. Hierfür wird jeweils der Mittelpunkt der Gerade zwischen zwei Mittellinienpunkten genutzt. Bei \( n \) Mittellinienpunkten entstehen also \( n-1 \) linear interpolierte Punkte.
\begin{equation}
\pnt{p_{\text{interpoliert}i}} = (\pnt{p_{\text{real}i}}+\pnt{p_{\text{real}i+1}})/2 
\end{equation}
\paragraph{Algorithmus} Die Prozedur zum Vergleich der Seitenlinien mit der mittleren Fahrbahnmarkierung ist weitgehend identisch mit Abschnitt~\ref{sssec:fahrspurerkennung:riverflow:verifikation:seitenlinienvergleich}. Lediglich das Auswählen einer Hypothese der Mittellinie entfällt, da hier in jedem Fall nur ein möglicher Verlauf gefunden wird.

\subsubsection{Zusammenführung der Verifikationsmethoden}
Lieferte die Überprüfung der seitlichen Fahrbahnmarkierungen aneinander die längere Koordinatenserie, so wird diese weiter verwendet. Andernfalls wird die Menge der an der mittleren Linie validierten Punkte genutzt.
